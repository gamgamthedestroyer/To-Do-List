<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List</title>
    <style>
        body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    transition: background-color 0.3s, color 0.3s;
    background-color: #ffffff;
    color: #333333;
    overflow-x: hidden;
}

.dark-mode {
    background-color: #333333;
    color: #ffffff;
}

.container {
    padding: 20px;
    max-width: 800px;
    margin: 0 auto;
    box-sizing: border-box;
}

.top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 20px;
}

.button {
    padding: 10px 20px;
    margin: 10px;
    cursor: pointer;
    border: 1px solid;
    border-radius: 5px;
    background-color: transparent;
    color: inherit;
    transition: background-color 0.3s, color 0.3s;
}

.dark-mode .button {
    border-color: #ffffff;
    color: #ffffff;
}

.button:hover {
    background-color: #007bff;
    color: white;
}

.dark-mode .button:hover {
    background-color: #0056b3;
}

.task-bubble {
    margin: 10px 0;
    padding: 10px;
    background-color: #f0f0f0;
    border-radius: 10px;
    border: 1px solid #ccc;
    overflow: hidden;
    transition: background-color 0.3s, color 0.3s;
    position: relative;
    display: flex;
    flex-direction: column;
}

.dark-mode .task-bubble {
    background-color: #444444;
    border-color: #555555;
}

.task {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background-color: transparent;
    transition: background-color 0.3s, color 0.3s;
    padding: 10px;
}

.task.checked {
    background-color: #d0f0d0;
    color: #333333;
}

.dark-mode .task.checked {
    color: #000000;
}

.task input[type="text"] {
    border: none;
    background-color: transparent;
    flex-grow: 1;
    margin: 0 10px;
    padding: 5px;
    color: inherit;
}

.task input[type="text"]:focus {
    outline: none;
    border-bottom: 2px solid #007bff;
}

.task select, .task input[type="date"] {
    margin-left: 10px;
}

.subtasks {
    margin-top: 10px;
    display: none;
    padding-left: 20px;
}

.search-bar {
    margin-bottom: 20px;
}

.search-bar input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

.search-bar input:focus {
    border-color: #007bff;
    outline: none;
}

.controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
}

.slider {
    width: 100px;
}

.arrow {
    cursor: pointer;
    margin-right: 10px;
    color: #333333;
    transition: color 0.3s;
}

.dark-mode .arrow {
    color: #dddddd;
}

.checkbox {
    margin-right: 10px;
    cursor: pointer;
}

.format-controls {
    display: flex;
    align-items: center;
}

.format-controls button {
    margin: 0 2px;
}

.delete-button {
    background-color: transparent;
    border-color: #ccc;
    color: inherit;
}

.delete-button:hover {
    background-color: #e0e0e0;
}

.footer {
    position: fixed;
    bottom: 0;
    width: 100%;
    background-color: #f0f0f0;
    color: #333333;
    text-align: center;
    padding: 10px;
    border-top: 1px solid #ccc;
    box-sizing: border-box;
}

.dark-mode .footer {
    background-color: #444444;
    color: #ffffff;
    border-top: 1px solid #555555;
}

.scrollable {
    max-height: calc(100vh - 80px); /* Adjust based on footer height */
    overflow-y: auto;
    padding-bottom: 60px; /* Ensure there's space for the footer */
}

.priority-indicator {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
}

.priority-high {
    background-color: #d9534f;
}

.priority-medium {
    background-color: #f0ad4e;
}

.priority-low {
    background-color: #5bc0de;
}

.priority-none {
    background-color: #e0e0e0;
}

    </style>
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <h1>To-Do List</h1>
            <div>
                <button id="theme-toggle" class="button">Toggle Dark Mode</button>
                <button id="add-task" class="button">Add Task</button>
                <button id="clear-completed" class="button">Clear Completed Tasks</button>
            </div>
        </div>

        <div class="search-bar">
            <input type="text" id="search" placeholder="Search tasks...">
        </div>

        <div id="tasks-container" class="scrollable">
            <!-- Tasks will be added here -->
        </div>
    </div>

    <div class="footer">
        <p>Created by Grahym V.1 WIP</p>
        <p>Contact grahym. on Discord for suggestions and/or help.</p>
    </div>

    <script>
        const themeToggleButton = document.getElementById('theme-toggle');
        const addTaskButton = document.getElementById('add-task');
        const clearCompletedButton = document.getElementById('clear-completed');
        const tasksContainer = document.getElementById('tasks-container');
        const searchInput = document.getElementById('search');

        // Toggle dark mode
        themeToggleButton.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
        });

        // Add a new task
        addTaskButton.addEventListener('click', () => {
            const taskBubble = createTaskBubble();
            tasksContainer.appendChild(taskBubble);
        });

        // Clear completed tasks
        clearCompletedButton.addEventListener('click', () => {
            document.querySelectorAll('.task.checked').forEach(task => {
                task.parentElement.remove();
            });
        });

        function createTaskBubble() {
            const taskBubble = document.createElement('div');
            taskBubble.className = 'task-bubble';

            const task = createTask();
            taskBubble.appendChild(task);

            const subtasksContainer = document.createElement('div');
            subtasksContainer.className = 'subtasks';
            taskBubble.appendChild(subtasksContainer);

            return taskBubble;
        }

        function createTask() {
            const task = document.createElement('div');
            task.className = 'task';
            task.innerHTML = `
                <input type="checkbox" class="checkbox">
                <input type="text" value="New Task" />
                <input type="date" class="due-date" />
                <select class="priority-select">
                    <option value="none">Priority</option>
                    <option value="high">High</option>
                    <option value="medium">Medium</option>
                    <option value="low">Low</option>
                </select>
                <span class="priority-indicator priority-none"></span>
                <button class="button add-subtask">Add Sub-task</button>
                <button class="button delete-task delete-button">Delete Task</button>
            `;

            const input = task.querySelector('input[type="text"]');
            const dueDateInput = task.querySelector('.due-date');
            const prioritySelect = task.querySelector('.priority-select');
            const priorityIndicator = task.querySelector('.priority-indicator');
            const addSubtaskButton = task.querySelector('.add-subtask');
            const deleteTaskButton = task.querySelector('.delete-task');
            const checkbox = task.querySelector('.checkbox');

            // Edit task
            input.addEventListener('blur', () => {
                input.value = input.value.trim() || 'New Task';
            });

            dueDateInput.addEventListener('change', () => {
                const dueDate = new Date(dueDateInput.value);
                if (dueDate < new Date()) {
                    alert('Due date cannot be in the past.');
                    dueDateInput.value = '';
                }
            });

            // Add Sub-task
            addSubtaskButton.addEventListener('click', () => {
                const subtasks = task.parentElement.querySelector('.subtasks');
                const subtask = createSubtask();
                subtasks.appendChild(subtask);
                subtasks.style.display = 'block';
            });

            // Delete Task
            deleteTaskButton.addEventListener('click', () => {
                task.parentElement.remove();
            });

            // Mark task as checked
            checkbox.addEventListener('change', () => {
                task.classList.toggle('checked', checkbox.checked);
            });

            // Update priority color
            prioritySelect.addEventListener('change', () => {
                const priorityValue = prioritySelect.value;
                task.classList.remove('priority-high', 'priority-medium', 'priority-low');
                priorityIndicator.className = 'priority-indicator';

                switch (priorityValue) {
                    case 'high':
                        task.classList.add('priority-high');
                        priorityIndicator.classList.add('priority-high');
                        input.style.color = '#ffffff'; // White for dark red
                        break;
                    case 'medium':
                        task.classList.add('priority-medium');
                        priorityIndicator.classList.add('priority-medium');
                        input.style.color = '#000000'; // Black for dark orange
                        break;
                    case 'low':
                        task.classList.add('priority-low');
                        priorityIndicator.classList.add('priority-low');
                        input.style.color = '#ffffff'; // White for dark blue
                        break;
                    default:
                        priorityIndicator.classList.remove('priority-high', 'priority-medium', 'priority-low');
                        input.style.color = ''; // Reset color
                        break;
                }
            });

            return task;
        }

        function createSubtask() {
            const subtask = document.createElement('div');
            subtask.className = 'task';
            subtask.innerHTML = `
                <input type="checkbox" class="checkbox">
                <input type="text" value="New Subtask" />
                <button class="button delete-task delete-button">Delete</button>
            `;

            const deleteButton = subtask.querySelector('.delete-task');
            const checkbox = subtask.querySelector('.checkbox');

            deleteButton.addEventListener('click', () => {
                subtask.remove();
            });

            checkbox.addEventListener('change', () => {
                subtask.classList.toggle('checked', checkbox.checked);
            });

            return subtask;
        }

        // Search functionality
        searchInput.addEventListener('input', () => {
            const query = searchInput.value.toLowerCase();
            document.querySelectorAll('.task-bubble').forEach(taskBubble => {
                const taskText = taskBubble.querySelector('input[type="text"]').value.toLowerCase();
                taskBubble.style.display = taskText.includes(query) ? 'block' : 'none';
            });
        });
    </script>
</body>
</html>
